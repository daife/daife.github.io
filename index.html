<!DOCTYPE html>
<html>
<head>
    <title>无缓存博客</title>
    <style>
        .my-button { padding: 12px 24px; background: #2ea44f; color: white; }
    </style>
</head>
<body>
    <a href="#" id="profile-link" class="my-button">加载中...</a>

    <script>
        async function fetchConfig() {
            try {
                // 1. 获取最新 Commit SHA
                const commitRes = await fetch(
                    'https://api.github.com/repos/daife/daife.github.io/commits?path=config.json&per_page=1',
                    { cache: 'no-cache' }
                );
                const commits = await commitRes.json();
                const sha = commits[0].sha;

                // 2. 构建无缓存链接
                const url = `https://raw.githubusercontent.com/daife/daife.github.io/${sha}/config.json?t=${Date.now()}`;

                // 3. 请求配置（禁用所有缓存）
                const configRes = await fetch(url, {
                    cache: 'no-cache',
                    headers: { 'Cache-Control': 'no-cache' }
                });
                const config = await configRes.json();

                // 4. 更新按钮
                const button = document.getElementById('profile-link');
                button.href = config.profile_url;
                button.textContent = '实时跳转链接';
            } catch (error) {
                console.error('加载失败:', error);
                const button = document.getElementById('profile-link');
                button.textContent = '加载失败，点击重试';
                button.onclick = fetchConfig;
            }
        }

        // 初始化加载
        fetchConfig();
    </script>
</body>
</html>
